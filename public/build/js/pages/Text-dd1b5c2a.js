import{i as E,B as S,m as y,j as k,C as v,_ as C,r as c,o as a,g as h,w as m,a as t,b as l,c as i,F as L,v as M,x as D,e as g,y as H,ae as N,I as P,ak as R,l as F,b_ as U,aD as $,E as w,d as x,t as p,aH as B}from"../../assets/app-73d10358.js";import{B as Y,S as q}from"./Songs-a984762d.js";const G={components:{SlimScroll:E,BaseIcon:S},computed:{...y(k,["storyBackgrounds","selectedBackground"])},mounted(){this.getStoryBackgrounds()},methods:{...v(k,["getStoryBackgrounds","selectBackground"])}},J=["onClick"],K=["src"],O={class:"absolute top-1/2 -translate-y-1/2 -left-2 flex items-center justify-center w-8 h-8 bg-white rounded-full shadow-md text-main-color dark:bg-slate-800 dark:text-white dark:shadow-slate-600 z-10"},Q={class:"absolute top-1/2 -translate-y-1/2 -right-2 flex items-center justify-center w-8 h-8 bg-white rounded-full shadow-md text-main-color dark:bg-slate-800 dark:text-white dark:shadow-slate-600 z-10"};function W(s,e,T,z,o,n){const d=c("BaseIcon"),f=c("SlimScroll");return s.storyBackgrounds.length>0?(a(),h(f,{key:0,class:"bg-white rounded-full dark:bg-slate-800",padding:2},{prev:m(()=>[t("button",O,[l(d,{name:"caret_left"})])]),next:m(()=>[t("button",Q,[l(d,{name:"caret_right"})])]),default:m(()=>[(a(!0),i(L,null,M(s.storyBackgrounds,u=>(a(),i("div",{class:"backgrounds-list-item",key:u.id,onClick:b=>s.selectBackground(u)},[t("img",{class:D(["transition-all w-8 h-8 rounded-full cursor-pointer",u.is_selected?"border-2 border-color-link scale-125 dark:border-dark-primary-color":""]),src:u.photo_url},null,10,K)],8,J))),128))]),_:1})):g("",!0)}const X=C(G,[["render",W]]),Z={components:{BaseIcon:S,BaseButton:H,BaseColorPicker:Y,BaseTextarea:N,Backgrounds:X,Songs:q,ContentHtml:P,CloseButton:R},inject:["dialogRef"],data(){return{type:"text",content:null,color:"#ffffff",photo:null,selected_song:null,showSongsList:!1,showBackgroundsList:!1,showAddTextarea:!0,loading:!1}},mounted(){this.getStoryBackgrounds()},unmounted(){this.selectBackground(null)},computed:{...y(k,["storyBackgrounds","selectedBackground"]),...y(F,["isMobile"])},watch:{$route(){this.dialogRef.close()}},methods:{...v(k,["getStoryBackgrounds","selectBackground"]),toggleSongsList(){this.showSongsList=!this.showSongsList},toggleAddTextarea(){this.showAddTextarea=!this.showAddTextarea},selectSong(s){this.selected_song=s,this.toggleSongsList()},removeSong(){this.selected_song=null},toggleBackgroundsList(){this.showBackgroundsList=!this.showBackgroundsList},async postStory(){if(!this.loading){this.loading=!0;try{await U({type:this.type,content:this.content,content_color:this.color,song_id:this.selected_song?this.selected_song.id:0,background_id:this.selectedBackground.id,photo:this.photo}),this.showSuccess(this.$t("Your story has been posted.")),this.closeCreateStoryModal(),this.$router.push({name:"home"})}catch(s){this.showError(s.error)}finally{this.loading=!1}}},closeCreateStoryModal(){this.dialogRef.close()}}},ee={class:"h-full"},te={class:"flex h-full"},oe={class:"absolute top-3 left-3 right-3 z-10"},se={class:"flex gap-2 justify-between items-center"},ne={class:"flex gap-2"},le={key:0,class:"bg-black text-white px-2 py-1 text-xs rounded-lg inline-flex items-center gap-1 relative mt-4 z-10"},re={key:0,class:"absolute top-14 left-3 right-3 z-10"},ae={class:"relative leading-none"},ce={class:"absolute bottom-3 end-3"},de={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center text-main-color text-xl max-w-[80%] w-full max-h-[60%] overflow-x-hidden overflow-y-auto story-content-box"},ie={key:1,class:"text-sub-color dark:text-slate-300"};function ue(s,e,T,z,o,n){const d=c("BaseIcon"),f=c("BaseButton"),u=c("BaseTextarea"),b=c("BaseColorPicker"),V=c("Songs"),A=c("Backgrounds"),j=c("ContentHtml"),I=c("CloseButton"),_=$("click-outside");return a(),i(L,null,[t("div",ee,[t("div",te,[t("div",{class:"flex-1 bg-cover lg:rounded-base-lg bg-center relative",style:w({backgroundImage:"url("+s.selectedBackground.photo_url+")"})},[t("span",oe,[t("div",se,[t("div",ne,[t("button",{class:"flex justify-center items-center bg-white shadow-md h-8 w-8 rounded-full dark:bg-slate-800 rtl:rotate-180",onClick:e[0]||(e[0]=r=>n.closeCreateStoryModal())},[l(d,{name:"arrow_left"})]),t("button",{class:"flex justify-center items-center bg-white shadow-md h-8 w-8 rounded-full dark:bg-slate-800",onClick:e[1]||(e[1]=r=>n.toggleSongsList())},[l(d,{name:"music_notes"})]),t("button",{class:"flex justify-center items-center bg-white shadow-md h-8 w-8 rounded-full dark:bg-slate-800",onClick:e[2]||(e[2]=r=>n.toggleAddTextarea())},[l(d,{name:"character"})])]),l(f,{loading:o.loading,onClick:e[3]||(e[3]=r=>n.postStory())},{default:m(()=>[x(p(s.$t("Post Story")),1)]),_:1},8,["loading"])]),o.selected_song?(a(),i("span",le,[l(d,{name:"music_note",size:"16"}),x(" "+p(o.selected_song.name)+" ",1),t("button",{onClick:e[4]||(e[4]=(...r)=>n.removeSong&&n.removeSong(...r)),class:"absolute -top-2 -end-2 bg-red-600 text-white rounded-full"},[l(d,{name:"close",size:"16"})])])):g("",!0)]),o.showAddTextarea?B((a(),i("div",re,[t("div",ae,[l(u,{maxlength:1024,modelValue:o.content,"onUpdate:modelValue":e[5]||(e[5]=r=>o.content=r),placeholder:s.$t("Enter Text"),autofocus:!0,classInput:"pe-10 max-h-40"},null,8,["modelValue","placeholder"]),t("span",ce,[l(b,{modelValue:o.color,"onUpdate:modelValue":e[6]||(e[6]=r=>o.color=r)},null,8,["modelValue"])])])])),[[_,n.toggleAddTextarea]]):g("",!0),o.showSongsList?B((a(),h(V,{key:1,class:"absolute top-14 left-3 right-3 z-10",onSelect_song:n.selectSong},null,8,["onSelect_song"])),[[_,n.toggleSongsList]]):g("",!0),s.storyBackgrounds.length>0?(a(),i("button",{key:2,class:"absolute bottom-4 start-3 z-10",onClick:e[7]||(e[7]=r=>n.toggleBackgroundsList())},[l(d,{name:"background"})])):g("",!0),o.showBackgroundsList?B((a(),h(A,{key:3,class:"absolute bottom-3 left-3 right-3 z-20"},null,512)),[[_,n.toggleBackgroundsList]]):g("",!0),t("div",de,[o.content?(a(),h(j,{key:0,style:w({color:o.color}),content:o.content,limit:100},null,8,["style","content"])):(a(),i("span",ie,p(s.$t("Enter Text")),1))])],4)])]),l(I,{onClick:e[8]||(e[8]=r=>n.closeCreateStoryModal())})],64)}const me=C(Z,[["render",ue]]);export{me as default};
