import{_ as T,y as C,r as u,o as r,c as d,a as s,t as a,b as c,w as p,d as f,cm as S,m as y,u as v,l as $,F as k,v as x,x as D,g as A,e as w,C as V,aW as U,P as W,s as B,a3 as P,a5 as L,O as F}from"../../assets/app-73d10358.js";import{g as I,a as M,b as N,c as E,d as R,e as j}from"./wallet-717c3b3c.js";import{B as q}from"./BaseRadio-888a0fc0.js";import{s as z}from"./autocomplete.esm-ddce204a.js";import{A as G}from"./AutoSuggestUserItem-21d9e14b.js";import{B as O}from"./BaseCalendar-0db4a3ac.js";import"./index.esm-4d5906a6.js";const Y={components:{BaseButton:C}},H={class:"mb-base-2"},J={class:"text-end"};function K(e,o,h,b,t,n){const m=u("BaseButton");return r(),d("div",null,[s("p",H,a(e.$t("Before you can transfer funds, itâ€™s important that we verify your uniqueness. Click on the below button to start the verification process.")),1),s("div",J,[c(m,{to:{name:"verify_profile"}},{default:p(()=>[f(a(e.$t("Verify now")),1)]),_:1})])])}const Q=T(Y,[["render",K]]),X={components:{BaseInputNumber:S,BaseRadio:q,BaseButton:C},data(){return{fundAmount:null,packageId:null,gatewayId:null,walletPackagesList:[],loadingProceed:!1}},computed:{...y(v,["user"]),...y($,["config","gateways"])},mounted(){this.getWalletPackages()},methods:{async getWalletPackages(){try{const e=await I();this.walletPackagesList=e}catch(e){console.log(e)}},handleChangeFundAmount(){this.packageId=null},handleClickPackage(e){this.packageId=e.id,this.fundAmount=e.amount},async handleClickProceed(){this.loadingProceed=!0;try{const e=await M({gateway_id:this.gatewayId,amount:this.fundAmount,package_id:this.packageId});window.location.href=e.url,this.loadingProceed=!1}catch(e){this.showError(e.error),this.loadingProceed=!1}}}},Z={class:"mb-base-2"},ee={class:"text-base-xs mb-base-2"},se={class:"flex flex-wrap gap-x-6 gap-y-base-2 mb-base-2"},te=["onClick"],oe={class:"font-bold mb-base-2"},ae={key:0},le={class:"flex flex-col gap-3 mb-base-2"},ne=["for"],re={key:1},ie={class:"mb-base-2"},de={class:"text-end"};function ce(e,o,h,b,t,n){const m=u("BaseInputNumber"),_=u("BaseRadio"),g=u("BaseButton");return r(),d("div",null,[s("p",Z,a(e.$t("Amount")+" ( "+e.exchangeTokenCurrency(1))+" = "+a(e.exchangeCurrency(1)+")"),1),c(m,{modelValue:t.fundAmount,"onUpdate:modelValue":o[0]||(o[0]=i=>t.fundAmount=i),onInput:n.handleChangeFundAmount,placeholder:e.$t("Value"),autofocus:"",class:"max-w-[240px] mb-base-2"},null,8,["modelValue","onInput","placeholder"]),s("p",ee,a("~ "+e.exchangeCurrency(t.fundAmount)),1),s("div",se,[(r(!0),d(k,null,x(t.walletPackagesList,i=>(r(),d("button",{key:i.id,onClick:l=>n.handleClickPackage(i),class:D(["text-primary-color dark:text-dark-primary-color",i.id===t.packageId&&i.amount===t.fundAmount?"font-bold":""])},a(i.amount),11,te))),128))]),s("h5",oe,a(e.$t("Payment method")),1),e.gateways.length>0?(r(),d("div",ae,[s("div",le,[(r(!0),d(k,null,x(e.gateways,i=>(r(),d("div",{key:i.id,class:"flex items-center gap-3"},[c(_,{modelValue:t.gatewayId,"onUpdate:modelValue":o[1]||(o[1]=l=>t.gatewayId=l),inputId:i.name,name:"payment_method",value:i.id},null,8,["modelValue","inputId","value"]),s("label",{for:i.name},a(i.name),9,ne)]))),128))]),t.fundAmount?(r(),A(g,{key:0,onClick:o[2]||(o[2]=i=>n.handleClickProceed()),loading:t.loadingProceed},{default:p(()=>[f(a(e.$t("Proceed to add")+" "+e.exchangeTokenCurrency(t.fundAmount)),1)]),_:1},8,["loading"])):w("",!0)])):(r(),d("div",re,[s("p",ie,a(e.$t("Payment method is not available. Please contact admin for detail")),1),s("div",de,[c(g,{to:{name:"contact"}},{default:p(()=>[f(a(e.$t("Contact admin")),1)]),_:1})])]))])}const ue=T(X,[["render",ce]]),me={components:{BaseInputNumber:S,BaseButton:C,AutoComplete:z,AutoSuggestUserItem:G},data(){return{disableAutoComplete:!1,userMentionList:null,selectedUser:[],fundAmount:null,onlySearchUser:!1,notSearchMyself:!0}},inject:["dialogRef"],computed:{...y(v,["user"]),...y($,["config"])},methods:{...V(v,["sendFund"]),...V(U,["pingNotification"]),handleItemSelect(){this.disableAutoComplete=!0},handleItemUnselect(){this.disableAutoComplete=!1},async suggestUsersMention(e){try{const o=await N(e.query);this.userMentionList=o}catch{this.userMentionList=[]}},sendFundToUser(){if(this.selectedUser.length===0){this.showError(this.$t("Please select user to send fund."));return}const e=this.$dialog.open(W,{props:{header:this.$t("Enter Password"),class:"password-modal",modal:!0,dismissableMask:!0,draggable:!1},emits:{onConfirm:async o=>{if(o.password)try{await E({amount:this.fundAmount,id:this.selectedUser[0].id,password:o.password}),this.pingNotification(),this.dialogRef.close(),e.close(),B(),this.showSuccess(this.$t("Send fund successfully."))}catch(h){this.showError(h.error),e.close(),B()}}}})}}},he={class:"mb-base-2"},pe={class:"mb-1"},fe={class:"mb-base-2"},ge={class:"mb-1"},be={class:"text-base-xs mb-base-2"},_e={class:"text-end"};function ye(e,o,h,b,t,n){const m=u("AutoSuggestUserItem"),_=u("AutoComplete"),g=u("BaseInputNumber"),i=u("BaseButton");return r(),d("form",{onSubmit:o[2]||(o[2]=P((...l)=>n.sendFundToUser&&n.sendFundToUser(...l),["prevent"]))},[s("div",he,[s("div",pe,[s("label",null,a(e.$t("Username")),1)]),c(_,{modelValue:t.selectedUser,"onUpdate:modelValue":o[0]||(o[0]=l=>t.selectedUser=l),multiple:"",disabled:t.disableAutoComplete,optionLabel:"name",suggestions:t.userMentionList,onItemSelect:n.handleItemSelect,onItemUnselect:n.handleItemUnselect,onComplete:n.suggestUsersMention,emptySearchMessage:e.$t("No users found"),class:"w-full"},{option:p(l=>[c(m,{user:l.option},null,8,["user"])]),_:1},8,["modelValue","disabled","suggestions","onItemSelect","onItemUnselect","onComplete","emptySearchMessage"])]),s("div",fe,[s("div",ge,[s("label",null,a(e.$t("Amount")),1)]),c(g,{modelValue:t.fundAmount,"onUpdate:modelValue":o[1]||(o[1]=l=>t.fundAmount=l),placeholder:e.$t("Value"),class:"mb-base-2"},null,8,["modelValue","placeholder"]),s("p",be,a(e.$t("Availables")+": "+e.exchangeTokenCurrency(e.user.wallet_balance)),1)]),s("div",_e,[c(i,{disabled:!t.fundAmount},{default:p(()=>[f(a(e.$t("Send")),1)]),_:1},8,["disabled"])])],32)}const we=T(me,[["render",ye]]),ke={components:{BaseButton:C,BaseSelect:L,BaseCalendar:O,Loading:F},data(){return{selectedWalletType:"all",walletTypesList:[],selectedWalletDate:"30_day",walletDatesList:[{key:this.$t("Past 30 days"),value:"30_day"},{key:this.$t("Past 60 days"),value:"60_day"},{key:this.$t("Past 90 days"),value:"90_day"},{key:this.$t("Custom"),value:"custom"}],customFromDate:null,customToDate:null,transactionsList:[],transactionPage:1,loadmoreTransaction:!1,loadingTransaction:!0,loadingApply:!1,loadingViewMore:!1}},computed:{...y(v,["user"]),...y($,["config"])},mounted(){if(this.getWalletTypes(),this.getWalletTransactions(this.transactionPage,this.selectedWalletType,this.selectedWalletDate),!this.config.wallet.enable)return this.$router.push({name:"permission"})},methods:{async getWalletTypes(){try{const e=await R();this.walletTypesList=window._.map(e.types,function(o,h){return{key:o,value:h}})}catch(e){console.log(e)}},async getWalletTransactions(e,o,h){this.loadingViewMore=!0;try{var b="",t="";if(h==="custom"&&(this.customFromDate&&(b=this.formatDateTime(this.customFromDate)),this.customToDate&&(t=this.formatDateTime(this.customToDate)),this.customToDate<this.customFromDate)){this.showError(this.$t("To Date should be greater than From Date.")),this.loadingApply=!1;return}const n=await j(e,o,h,b,t);e===1?this.transactionsList=n.items:this.transactionsList=window._.concat(this.transactionsList,n.items),n.has_next_page?(this.loadmoreTransaction=!0,this.transactionPage++):this.loadmoreTransaction=!1,this.loadingTransaction=!1,this.loadingApply=!1,this.loadingViewMore=!1}catch(n){console.log(n),this.loadingApply=!1,this.loadingViewMore=!1}},handleSearchTransactions(){this.loadingApply=!0,this.transactionPage=1,this.getWalletTransactions(this.transactionPage,this.selectedWalletType,this.selectedWalletDate)},handleClickAddFund(){this.$dialog.open(ue,{props:{header:this.$t("Add fund to wallet"),class:"add-fund-modal",modal:!0,dismissableMask:!0,draggable:!1}})},handleClickTransfer(){if(this.user){let e="wallet.transfer_fund";this.checkPermission(e)&&(this.config.wallet.fundTransferVerifyEnable&&!this.user.is_verify?this.$dialog.open(Q,{props:{header:this.$t("Profile Verification"),class:"verification-modal",modal:!0,dismissableMask:!0,draggable:!1}}):this.$router.push({name:"wallet_transfer"}))}},handleClickSendFund(){if(this.user){let e="wallet.send_fund";this.checkPermission(e)&&this.$dialog.open(we,{props:{header:this.$t("Send funds to user"),class:"send-fund-modal",modal:!0,dismissableMask:!0,draggable:!1}})}}}},ve={class:"main-content-section bg-white border border-white text-main-color rounded-none md:rounded-base-lg p-5 mb-base-2 dark:bg-slate-800 dark:border-slate-800 dark:text-white"},Te={class:"flex flex-wrap items-center justify-between gap-2 mb-base-2"},Ce={class:"text-main-color text-base-lg font-extrabold dark:text-white"},xe={class:"flex flex-wrap items-center justify-between gap-x-4 gap-y-base-2"},Ae={class:"text-base-xs mb-1"},$e={class:"font-bold mb-1"},Ve={class:"text-base-xs"},Be={class:"flex flex-wrap gap-base-2"},Se={class:"main-content-section bg-white border border-white text-main-color rounded-none md:rounded-base-lg p-5 mb-base-2 dark:bg-slate-800 dark:border-slate-800 dark:text-white"},Pe={class:"widget-box-header flex flex-wrap items-center justify-between gap-2 mb-base-2"},De={class:"text-main-color text-base-lg font-extrabold dark:text-white"},Ue={class:"flex flex-wrap gap-base-2 mb-base-2"},We={class:"flex flex-col gap-base-2 flex-1"},Le={class:"flex flex-col sm:flex-row flex-wrap gap-base-2"},Fe={key:0,class:"flex flex-col sm:flex-row flex-wrap gap-base-2"},Ie={class:"relative overflow-x-auto border border-b-0 border-table-border-color md:rounded-md dark:border-white/10"},Me={class:"w-full text-sm whitespace-nowrap text-center"},Ne={class:"text-xs uppercase bg-table-header-color dark:bg-dark-web-wash"},Ee={scope:"col",class:"p-3 text-start"},Re={scope:"col",class:"p-3"},je={scope:"col",class:"p-3"},qe={scope:"col",class:"p-3"},ze={scope:"col",class:"p-3"},Ge={key:0},Oe={colspan:"5"},Ye={class:"p-3 text-start"},He={class:"p-3"},Je={class:"p-3"},Ke={class:"p-3"},Qe={class:"p-3"},Xe={key:1,class:"border-b border-table-border-color dark:border-gray-700"},Ze={colspan:"5",class:"p-3"},es={key:0,class:"text-center my-base-2"};function ss(e,o,h,b,t,n){const m=u("BaseButton"),_=u("BaseSelect"),g=u("BaseCalendar"),i=u("Loading");return r(),d(k,null,[s("div",ve,[s("div",Te,[s("h3",Ce,a(e.$t("Wallet")),1)]),s("div",xe,[s("div",null,[s("p",Ae,a(e.$t("Your balance")),1),s("div",$e,a(e.exchangeTokenCurrency(e.user.wallet_balance))+" ~ "+a(e.exchangeCurrency(e.user.wallet_balance)),1),s("p",Ve,a(e.exchangeTokenCurrency(1))+" = "+a(e.exchangeCurrency(1)),1)]),s("div",Be,[e.user.can_show_withdraw_wallet?(r(),A(m,{key:0,onClick:o[0]||(o[0]=l=>n.handleClickTransfer())},{default:p(()=>[f(a(e.$t("Transfer fund")),1)]),_:1})):w("",!0),e.user.can_show_send_wallet?(r(),A(m,{key:1,onClick:o[1]||(o[1]=l=>n.handleClickSendFund())},{default:p(()=>[f(a(e.$t("Send fund")),1)]),_:1})):w("",!0),c(m,{onClick:o[2]||(o[2]=l=>n.handleClickAddFund())},{default:p(()=>[f(a(e.$t("Add fund")),1)]),_:1})])])]),s("div",Se,[s("div",Pe,[s("h3",De,a(e.$t("Billing activities")),1)]),s("div",Ue,[s("form",{class:"flex-1 flex flex-col md:flex-row flex-wrap gap-base-2",onSubmit:o[7]||(o[7]=P((...l)=>n.handleSearchTransactions&&n.handleSearchTransactions(...l),["prevent"]))},[s("div",We,[s("div",Le,[c(_,{modelValue:t.selectedWalletType,"onUpdate:modelValue":o[3]||(o[3]=l=>t.selectedWalletType=l),options:t.walletTypesList,optionLabel:"key",optionValue:"value",placeholder:e.$t("Type"),class:"flex-1"},null,8,["modelValue","options","placeholder"]),c(_,{modelValue:t.selectedWalletDate,"onUpdate:modelValue":o[4]||(o[4]=l=>t.selectedWalletDate=l),options:t.walletDatesList,optionLabel:"key",optionValue:"value",placeholder:e.$t("Date"),class:"flex-1"},null,8,["modelValue","options","placeholder"])]),t.selectedWalletDate==="custom"?(r(),d("div",Fe,[c(g,{modelValue:t.customFromDate,"onUpdate:modelValue":o[5]||(o[5]=l=>t.customFromDate=l),class:"flex-1",placeholder:e.$t("From")},null,8,["modelValue","placeholder"]),c(g,{modelValue:t.customToDate,"onUpdate:modelValue":o[6]||(o[6]=l=>t.customToDate=l),class:"flex-1",placeholder:e.$t("To")},null,8,["modelValue","placeholder"])])):w("",!0)]),c(m,{loading:t.loadingApply,class:"self-start w-full md:w-auto"},{default:p(()=>[f(a(e.$t("Apply")),1)]),_:1},8,["loading"])],32)]),s("div",Ie,[s("table",Me,[s("thead",Ne,[s("tr",null,[s("th",Ee,a(e.$t("Type")),1),s("th",Re,a(e.$t("Date")),1),s("th",je,a(e.$t("Gross")),1),s("th",qe,a(e.$t("Fee")),1),s("th",ze,a(e.$t("Net")),1)])]),s("tbody",null,[t.loadingTransaction?(r(),d("tr",Ge,[s("td",Oe,[c(i,{class:"mt-base-2"})])])):(r(),d(k,{key:1},[t.transactionsList.length?(r(!0),d(k,{key:0},x(t.transactionsList,l=>(r(),d("tr",{key:l.id,class:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b border-table-border-color dark:border-gray-700"},[s("td",Ye,a(l.description),1),s("td",He,a(l.created_at),1),s("td",Je,a(l.gross),1),s("td",Ke,a(l.fee),1),s("td",Qe,a(l.net),1)]))),128)):(r(),d("tr",Xe,[s("td",Ze,a(e.$t("No Transactions")),1)]))],64))])])]),t.loadmoreTransaction?(r(),d("div",es,[c(m,{onClick:o[8]||(o[8]=l=>n.getWalletTransactions(t.transactionPage,t.selectedWalletType,t.selectedWalletDate)),loading:t.loadingViewMore},{default:p(()=>[f(a(e.$t("View more")),1)]),_:1},8,["loading"])])):w("",!0)])],64)}const ds=T(ke,[["render",ss]]);export{ds as default};
