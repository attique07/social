import{_,y,H as I,bA as L,bB as B,r as g,o as d,c as n,b as h,a as c,F as f,v as p,t as u,e as x,w as S,d as V,a3 as k}from"../../assets/app-73d10358.js";import{B as T}from"./BaseCheckbox-e4290545.js";var b=null;const P={components:{BaseButton:y,BaseInputText:I,BaseCheckbox:T},inject:["dialogRef"],data(){return{categoryKeyword:null,categoriesList:[],filteredCategoriesList:[],selectedCategoryIds:this.dialogRef.data.selectedCategoryIds,selectedType:this.dialogRef.data.selectedType}},mounted(){this.fetchPageCategories()},methods:{closeStatusBox(){this.dialogRef.close()},async fetchPageCategories(){try{const e=await L();this.categoriesList=e,this.filteredCategoriesList=e}catch(e){console.log(e)}},handleChangeChildCategory(e){this.selectedCategoryIds.includes(e.id)||this.selectedCategoryIds.push(e.id)},handleChangeParentCategory(e){this.selectedCategoryIds.includes(e.id)||(this.selectedCategoryIds=window._.differenceBy(this.selectedCategoryIds,e.childs.map(t=>t.id)))},filterCategoriesList(e,t){return e.filter(o=>{var l=o.childs;return l&&l.length&&(o.childs=this.filterCategoriesList(l,t.toLowerCase()),o.childs&&o.childs.length)?!0:o.name.toLowerCase().indexOf(t.toLowerCase())>-1})},handleSearchCategories(){clearTimeout(b),b=setTimeout(()=>{const e=window._.cloneDeep(this.categoriesList);this.filteredCategoriesList=this.filterCategoriesList(e,this.categoryKeyword)},400)},selectedCategoriesList(e,t){var o=[];return window._.forEach(e,function(l){t.includes(l.id)&&o.push(l),l.childs&&l.childs.length&&window._.forEach(l.childs,function(i){t.includes(i.id)&&o.push(i)})}),o},async handleSelectCategories(){if(this.selectedType==="save")try{await B(this.selectedCategoryIds),this.showSuccess(this.$t("Your changes have been saved."))}catch(e){this.showError(e.error)}this.dialogRef.close({selectedCategoriesList:this.selectedCategoriesList(this.categoriesList,this.selectedCategoryIds)})}}},N={key:0},R={class:"flex justify-between items-center mb-4 font-bold"},E=["for"],K={key:0},j=["for"],U={key:1,class:"text-center pb-12"},D={class:"absolute left-0 bottom-0 right-0 px-6 pt-base-2 pb-6 rounded-b-base-lg bg-white dark:bg-slate-800"};function F(e,t,o,l,i,r){const w=g("BaseInputText"),C=g("BaseCheckbox"),v=g("BaseButton");return d(),n(f,null,[h(w,{modelValue:i.categoryKeyword,"onUpdate:modelValue":t[0]||(t[0]=s=>i.categoryKeyword=s),onInput:t[1]||(t[1]=s=>r.handleSearchCategories()),placeholder:e.$t("Search Categories"),class:"mb-base-2"},null,8,["modelValue","placeholder"]),c("form",{onSubmit:t[4]||(t[4]=k((...s)=>r.handleSelectCategories&&r.handleSelectCategories(...s),["prevent"]))},[i.categoriesList.length?(d(),n("div",N,[(d(!0),n(f,null,p(i.filteredCategoriesList,s=>(d(),n("div",{key:s.id},[c("div",R,[c("label",{for:s.id,class:"flex-1"},u(s.name),9,E),h(C,{value:s.id,modelValue:i.selectedCategoryIds,"onUpdate:modelValue":t[2]||(t[2]=a=>i.selectedCategoryIds=a),inputId:s.id.toString(),onChange:a=>r.handleChangeParentCategory(s)},null,8,["value","modelValue","inputId","onChange"])]),s.childs.length>0?(d(),n("div",K,[(d(!0),n(f,null,p(s.childs,a=>(d(),n("div",{key:a.id,class:"flex justify-between items-center ms-5 mb-4"},[c("label",{for:a.id,class:"flex-1"},u(a.name),9,j),h(C,{value:a.id,modelValue:i.selectedCategoryIds,"onUpdate:modelValue":t[3]||(t[3]=m=>i.selectedCategoryIds=m),inputId:a.id.toString(),onChange:m=>r.handleChangeChildCategory(s)},null,8,["value","modelValue","inputId","onChange"])]))),128))])):x("",!0)]))),128))])):(d(),n("div",U,u(e.$t("No results found")),1)),c("div",D,[h(v,{class:"w-full"},{default:S(()=>[V(u(e.$t("Select")),1)]),_:1})])],32)],64)}const H=_(P,[["render",F]]);export{H as S};
