import{ap as A,aV as P,o as d,c as p,a as s,aE as y,aI as k,_ as R,B as S,m as B,C as E,ci as D,cj as G,r as w,t as o,b as c,e as x,F as $,u as j,l as I}from"../../assets/app-73d10358.js";var L={root:{position:"relative"}},N={root:"p-chart"},F=A.extend({name:"chart",inlineStyles:L,classes:N}),M={name:"BaseChart",extends:k,props:{type:String,data:null,options:null,plugins:null,width:{type:Number,default:300},height:{type:Number,default:150},canvasProps:{type:null,default:null}},style:F,provide:function(){return{$parentInstance:this}}},C={name:"Chart",extends:M,emits:["select","loaded"],chart:null,watch:{data:{handler:function(){this.reinit()},deep:!0},type:function(){this.reinit()},options:function(){this.reinit()}},mounted:function(){this.initChart()},beforeUnmount:function(){this.chart&&(this.chart.destroy(),this.chart=null)},methods:{initChart:function(){var t=this;P(()=>import("./auto-0e6b2b23.js"),[],import.meta.url).then(function(r){t.chart&&(t.chart.destroy(),t.chart=null),r&&r.default&&(t.chart=new r.default(t.$refs.canvas,{type:t.type,data:t.data,options:t.options,plugins:t.plugins})),t.$emit("loaded",t.chart)})},getCanvas:function(){return this.$canvas},getChart:function(){return this.chart},getBase64Image:function(){return this.chart.toBase64Image()},refresh:function(){this.chart&&this.chart.update()},reinit:function(){this.initChart()},onCanvasClick:function(t){if(this.chart){var r=this.chart.getElementsAtEventForMode(t,"nearest",{intersect:!0},!1),a=this.chart.getElementsAtEventForMode(t,"dataset",{intersect:!0},!1);r&&r[0]&&a&&this.$emit("select",{originalEvent:t,element:r[0],dataset:a})}},generateLegend:function(){if(this.chart)return this.chart.generateLegend()}}};function l(e){"@babel/helpers - typeof";return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(e)}function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_(Object(r),!0).forEach(function(a){V(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function V(e,t,r){return t=z(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z(e){var t=T(e,"string");return l(t)=="symbol"?t:String(t)}function T(e,t){if(l(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t||"default");if(l(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U=["width","height"];function K(e,t,r,a,n,h){return d(),p("div",y({class:e.cx("root"),style:e.sx("root")},e.ptm("root"),{"data-pc-name":"chart"}),[s("canvas",y({ref:"canvas",width:e.width,height:e.height,onClick:t[0]||(t[0]=function(i){return h.onCanvasClick(i)})},O(O({},e.canvasProps),e.ptm("canvas"))),null,16,U)],16)}C.render=K;const q={components:{BaseIcon:S,Chart:C},data(){return{dataReportOverview:null,dataReportAudience:null,chartAgeData:null,chartAgeOptions:null,chartGenderData:null,chartGenderOptions:null}},mounted(){this.user.is_page?(this.getReportOverview(),this.getReportAudience()):this.setErrorLayout(!0)},computed:{...B(j,["user"])},methods:{...E(I,["setErrorLayout"]),async getReportOverview(){try{const e=await D();this.dataReportOverview=e}catch(e){this.showError(e.error)}},async getReportAudience(){try{const e=await G();this.dataReportAudience=e,this.setAgeChartData(),this.setAgeChartOptions(),this.setGenderChartData(),this.setGenderChartOptions()}catch(e){this.showError(e.error)}},getPercentGenderGroupByAge(e){return window._.flatMap(this.dataReportAudience.ages,t=>window._.map(window._.filter(t,{name:e}),"percent"))},setAgeChartData(){const e=window._.keys(this.dataReportAudience.ages),t=this.dataReportAudience.genders.map(r=>({label:r.name,backgroundColor:r.color,data:this.getPercentGenderGroupByAge(r.name)}));this.chartAgeData={labels:e,datasets:t}},setAgeChartOptions(){const e="#e0e0e0";this.chartAgeOptions={plugins:{legend:{labels:{color:"#94a3b8"}},tooltip:{callbacks:{label:function(t){let r=t.dataset.label||"";return r&&(r+=": "),t.parsed.y!==null&&(r+=t.parsed.y+"%")," "+r}}}},maintainAspectRatio:!1,scales:{x:{ticks:{color:"#94a3b8",font:{size:15}},grid:{display:!1}},y:{grid:{color:e,drawBorder:!1},suggestedMin:0,suggestedMax:100,ticks:{color:"#94a3b8",font:{size:15},stepSize:20,callback:function(t){return t+"%"}}}}}},setGenderChartData(){const e=this.dataReportAudience.follows.map(a=>a.name),t=this.dataReportAudience.follows.map(a=>a.percent),r=this.dataReportAudience.follows.map(a=>a.color);this.chartGenderData={labels:e,datasets:[{data:t,backgroundColor:r}]}},setGenderChartOptions(){this.chartGenderOptions={plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){return" "+e.label+": "+e.parsed+"%"}}}}}}}},H={class:"main-content-section bg-white border border-white text-main-color rounded-none md:rounded-base-lg p-5 mb-base-2 dark:bg-slate-800 dark:border-slate-800 dark:text-white"},J={class:"text-main-color text-base-lg font-extrabold dark:text-white mb-base-2"},Q={class:"mb-base-2"},W={class:"flex items-center gap-base-2 py-base-2 border-t border-divider dark:border-white/10"},X={class:"flex-1"},Y={class:"flex items-center gap-base-2 py-base-2 border-t border-divider dark:border-white/10"},Z={class:"flex-1"},ee={class:"flex items-center gap-base-2 py-base-2 border-t border-divider dark:border-white/10"},te={class:"flex-1"},re={class:"flex items-center gap-base-2 py-base-2 border-t border-divider dark:border-white/10"},ae={class:"flex-1"},se={class:"flex items-center gap-base-2 py-base-2 border-t border-divider dark:border-white/10"},oe={class:"flex-1"},ne={class:"main-content-section bg-white border border-white text-main-color rounded-none md:rounded-base-lg p-5 mb-base-2 dark:bg-slate-800 dark:border-slate-800 dark:text-white"},ie={class:"text-main-color text-base-lg font-extrabold dark:text-white mb-base-2"},ce={class:"mb-base-2"},le={key:0};function de(e,t,r,a,n,h){var f,b,g,m,v;const i=w("BaseIcon"),u=w("Chart");return d(),p($,null,[s("div",H,[s("h3",J,o(e.$t("Page overview")),1),s("div",Q,o(e.$t("Last 28 days")),1),s("div",W,[c(i,{name:"globe",cursor:!1}),s("div",X,o(e.$t("Post Reach")),1),s("div",null,o((f=n.dataReportOverview)==null?void 0:f.post_reach),1)]),s("div",Y,[c(i,{name:"users",cursor:!1}),s("div",Z,o(e.$t("Post Engagement")),1),s("div",null,o((b=n.dataReportOverview)==null?void 0:b.post_engagement),1)]),s("div",ee,[c(i,{name:"circle_check_outlined",cursor:!1}),s("div",te,o(e.$t("New Followers")),1),s("div",null,o((g=n.dataReportOverview)==null?void 0:g.follow),1)]),s("div",re,[c(i,{name:"comment",cursor:!1}),s("div",ae,o(e.$t("Comment")),1),s("div",null,o((m=n.dataReportOverview)==null?void 0:m.post_comment),1)]),s("div",se,[c(i,{name:"share",cursor:!1}),s("div",oe,o(e.$t("Share")),1),s("div",null,o((v=n.dataReportOverview)==null?void 0:v.post_share),1)])]),s("div",ne,[s("h3",ie,o(e.$t("Audience")),1),s("div",ce,o(e.$t("These values are based on total followers of your Page or profile.")),1),n.dataReportAudience?(d(),p("div",le,[c(u,{type:"bar",data:n.chartAgeData,options:n.chartAgeOptions,class:"h-64 mb-12"},null,8,["data","options"]),c(u,{type:"pie",data:n.chartGenderData,options:n.chartGenderOptions,class:"w-72 mx-auto"},null,8,["data","options"])])):x("",!0)])],64)}const he=R(q,[["render",de]]);export{he as default};
