import{_ as w,y as A,ca as S,P as U,cb as v,s as _,r as c,o as a,c as u,a as r,t as l,b as i,w as p,d as b,cc as L,cd as I,A as B,h as P,m as x,C as V,ce as E,cf as N,g as C,e as h,F as k,v as T,u as R,l as j}from"../../assets/app-73d10358.js";import{s as $}from"./autocomplete.esm-ddce204a.js";import{A as M}from"./AutoSuggestUserItem-21d9e14b.js";const D={components:{BaseButton:A,AutoComplete:$,AutoSuggestUserItem:M},data(){return{disableAutoComplete:!1,userMentionList:null,selectedUser:[],fundAmount:null}},inject:["dialogRef"],methods:{handleItemSelect(){this.disableAutoComplete=!0},handleItemUnselect(){this.disableAutoComplete=!1},async suggestUsersMention(e){try{const s=await S(e.query);this.userMentionList=s}catch{this.userMentionList=[]}},async handleClickAddModerator(){if(this.selectedUser.length===0){this.showError(this.$t("Please select user to add moderator."));return}const e=this.$dialog.open(U,{props:{header:this.$t("Enter Password"),class:"password-modal",modal:!0,dismissableMask:!0,draggable:!1},emits:{onConfirm:async s=>{if(s.password)try{const d=await v({id:this.selectedUser[0].id,password:s.password});this.showSuccess(this.$t("Add Moderator Successfully.")),e.close(),_(),this.dialogRef.close({adminInfo:d})}catch(d){this.showError(d.error),e.close(),_()}}}})}}},F={class:"mb-base-2"},q={class:"mb-1"};function O(e,s,d,y,n,o){const m=c("AutoSuggestUserItem"),f=c("AutoComplete"),g=c("BaseButton");return a(),u("div",null,[r("div",F,[r("div",q,[r("label",null,l(e.$t("Username")),1)]),i(f,{modelValue:n.selectedUser,"onUpdate:modelValue":s[0]||(s[0]=t=>n.selectedUser=t),multiple:"",disabled:n.disableAutoComplete,optionLabel:"name",suggestions:n.userMentionList,onItemSelect:o.handleItemSelect,onItemUnselect:o.handleItemUnselect,onComplete:o.suggestUsersMention,emptySearchMessage:e.$t("No users found"),class:"w-full"},{option:p(t=>[i(m,{user:t.option},null,8,["user"])]),_:1},8,["modelValue","disabled","suggestions","onItemSelect","onItemUnselect","onComplete","emptySearchMessage"])]),i(g,{onClick:s[1]||(s[1]=t=>o.handleClickAddModerator()),class:"w-full"},{default:p(()=>[b(l(e.$t("Add")),1)]),_:1})])}const z=w(D,[["render",O]]),G={components:{BaseButton:A,AutoComplete:$,AutoSuggestUserItem:M},data(){return{disableAutoComplete:!1,userMentionList:null,selectedUser:null,fundAmount:null,onlySearchUser:!0,notSearchMyself:!0}},inject:["dialogRef"],methods:{handleItemSelect(){this.disableAutoComplete=!0},handleItemUnselect(){this.disableAutoComplete=!1},async suggestUsersMention(e){try{const s=await L(e.query);this.userMentionList=s}catch{this.userMentionList=[]}},async handleClickAddModerator(){const e=this.$dialog.open(U,{props:{header:this.$t("Enter Password"),class:"password-modal",modal:!0,dismissableMask:!0,draggable:!1},emits:{onConfirm:async s=>{if(s.password)try{const d=await I({id:this.selectedUser[0].id,password:s.password});this.dialogRef.close({adminInfo:d}),e.close(),_(),this.showSuccess(this.$t("Transfer Admin Successfully.")),window.location.href=window.siteConfig.siteUrl}catch(d){this.showError(d.error),e.close(),_()}}}})}}},H={class:"mb-base-2"},J={class:"mb-1"};function K(e,s,d,y,n,o){const m=c("AutoSuggestUserItem"),f=c("AutoComplete"),g=c("BaseButton");return a(),u("div",null,[r("div",H,[r("div",J,[r("label",null,l(e.$t("Username")),1)]),i(f,{modelValue:n.selectedUser,"onUpdate:modelValue":s[0]||(s[0]=t=>n.selectedUser=t),multiple:"",disabled:n.disableAutoComplete,optionLabel:"name",suggestions:n.userMentionList,onItemSelect:o.handleItemSelect,onItemUnselect:o.handleItemUnselect,onComplete:o.suggestUsersMention,emptySearchMessage:e.$t("No users found"),class:"w-full"},{option:p(t=>[i(m,{user:t.option},null,8,["user"])]),_:1},8,["modelValue","disabled","suggestions","onItemSelect","onItemUnselect","onComplete","emptySearchMessage"])]),i(g,{onClick:s[1]||(s[1]=t=>o.handleClickAddModerator()),class:"w-full"},{default:p(()=>[b(l(e.$t("Transfer")),1)]),_:1})])}const Q=w(G,[["render",K]]),W={components:{Avatar:B,UserName:P,BaseButton:A},data(){return{currentPage:1,loadmoreAdminsList:!1,adminsList:[]}},mounted(){this.user.is_page?this.getAdminsList(this.currentPage):this.setErrorLayout(!0)},computed:{...x(R,["user"])},methods:{...V(j,["setErrorLayout"]),async getAdminsList(e){try{const s=await E(e);e==1&&(this.adminsList=[]),this.adminsList=window._.concat(this.adminsList,s.items),s.has_next_page?(this.loadmoreAdminsList=!0,this.currentPage++):this.loadmoreAdminsList=!1}catch(s){this.showError(s.error)}},handleClickTransferAdmin(){this.$dialog.open(Q,{props:{header:this.$t("Transfer Admin Account"),modal:!0,dismissableMask:!0,draggable:!1}})},handleClickAddModerator(){this.$dialog.open(z,{props:{header:this.$t("Add Moderator"),modal:!0,dismissableMask:!0,draggable:!1},onClose:e=>{e.data&&this.adminsList.push(e.data.adminInfo)}})},async handleRemoveModerator(e){this.$confirm.require({message:this.$t("Do you want to remove this user?"),header:this.$t("Please confirm"),acceptLabel:this.$t("Ok"),rejectLabel:this.$t("Cancel"),accept:async()=>{try{await N(e),this.showSuccess(this.$t("Remove Successfully")),this.user.is_owner_page?this.adminsList=this.adminsList.filter(s=>s.id!==e):window.location.href=window.siteConfig.siteUrl}catch(s){this.showError(s.error)}}})}}},X={class:"main-content-section bg-white border border-white text-main-color rounded-none md:rounded-base-lg p-5 mb-base-2 dark:bg-slate-800 dark:border-slate-800 dark:text-white mb-base-2"},Y={class:"flex flex-wrap items-center justify-between gap-2 mb-base-2"},Z={class:"text-base-lg font-extrabold"},ee={key:0,class:"users-list-item flex items-center gap-base-2 mb-base-2"},se={class:"flex-1 min-w-0"},te={key:0,class:"list_items_sub_text_color flex items-center text-xs text-sub-color dark:text-slate-400"},oe={class:"main-content-section bg-white border border-white text-main-color rounded-none md:rounded-base-lg p-5 mb-base-2 dark:bg-slate-800 dark:border-slate-800 dark:text-white mb-base-2"},re={class:"flex flex-wrap items-center justify-between gap-2 mb-base-2"},ne={class:"text-base-lg font-extrabold"},ae={class:"flex-1 min-w-0"},le={key:0,class:"list_items_sub_text_color flex items-center text-xs text-sub-color dark:text-slate-400"},ie=["onClick"],de={key:0,class:"text-center"};function ue(e,s,d,y,n,o){const m=c("BaseButton"),f=c("Avatar"),g=c("UserName");return a(),u(k,null,[r("div",X,[r("div",Y,[r("h3",Z,l(e.$t("Admin")),1),e.user.is_owner_page?(a(),C(m,{key:0,onClick:s[0]||(s[0]=t=>o.handleClickTransferAdmin())},{default:p(()=>[b(l(e.$t("Transfer Page")),1)]),_:1})):h("",!0)]),e.user.page_owner?(a(),u("div",ee,[i(f,{user:e.user.page_owner},null,8,["user"]),r("div",se,[i(g,{user:e.user.page_owner,class:"list_items_title_text_color"},null,8,["user"]),e.user.page_owner.show_follower?(a(),u("p",te,l(e.$filters.numberShortener(e.user.page_owner.follower_count,e.$t("[number] follower"),e.$t("[number] followers"))),1)):h("",!0)])])):h("",!0)]),r("div",oe,[r("div",re,[r("h3",ne,l(e.$t("Moderators")),1),e.user.is_owner_page?(a(),C(m,{key:0,onClick:s[1]||(s[1]=t=>o.handleClickAddModerator())},{default:p(()=>[b(l(e.$t("Add moderator")),1)]),_:1})):h("",!0)]),(a(!0),u(k,null,T(n.adminsList,t=>(a(),u("div",{key:t.id,class:"users-list-item flex items-center gap-base-2 mb-base-2"},[i(f,{user:t},null,8,["user"]),r("div",ae,[i(g,{user:t,class:"list_items_title_text_color"},null,8,["user"]),t.show_follower?(a(),u("p",le,l(e.$filters.numberShortener(t.follower_count,e.$t("[number] follower"),e.$t("[number] followers"))),1)):h("",!0)]),e.user.is_owner_page||e.user.parent.id===t.id?(a(),u("button",{key:0,onClick:ce=>o.handleRemoveModerator(t.id),class:"list_items_button text-xs text-primary-color cursor-pointer font-bold dark:text-dark-primary-color"},l(e.$t("Remove")),9,ie)):h("",!0)]))),128)),n.loadmoreAdminsList?(a(),u("div",de,[i(m,{onClick:s[2]||(s[2]=t=>o.getAdminsList(n.currentPage))},{default:p(()=>[b(l(e.$t("View more")),1)]),_:1})])):h("",!0)])],64)}const fe=w(W,[["render",ue]]);export{fe as default};
