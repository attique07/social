import{A as $,N as C,Q as x,y as R,m as v,u as k,C as I,a8 as g,_ as L,r,o as n,c as l,a as s,b as i,w as m,d as _,t as a,O as B,Y as E,e as N,g as b,F as w,v as j,a2 as S}from"../../assets/app-73d10358.js";import{P as V}from"./PostListsItem-021b25db.js";import"./PostDetailModal-38c76a2f.js";import"./CommentsList-b62f7880.js";const A={components:{Avatar:$,Mentionable:C,EmojiPicker:x,BaseButton:R},inject:["dialogRef"],data(){return{content:"",isRecommend:this.dialogRef.data.isRecommend,page:this.dialogRef.data.page}},computed:{...v(k,["user"])},methods:{...I(g,["postNewReviewFeed"]),addEmoji(e){this.$refs.recommendContent.addContent(e)},async handleClickRecommend(){try{const e=await this.postNewReviewFeed({content:this.content,is_recommend:this.isRecommend,page_id:this.page.id});this.dialogRef.close({review:e}),this.showSuccess(this.$t("Your review have been sent."))}catch(e){this.showError(e.error)}}}},M={class:"flex gap-base-2 border-b border-divider pb-base-2 mb-base-2 dark:border-white/10"},F={class:"flex-1"},Y={class:"text-end"};function D(e,t,y,P,o,c){const u=r("Avatar"),h=r("Mentionable"),p=r("EmojiPicker"),f=r("BaseButton");return n(),l("div",null,[s("div",M,[i(u,{user:e.user,router:!1,activePopover:!1},null,8,["user"]),s("div",F,[i(h,{modelValue:o.content,"onUpdate:modelValue":t[0]||(t[0]=d=>o.content=d),placeholder:o.isRecommend?e.$t("What do you recommend about")+" "+o.page.name+"?":e.$t("Leave your feedback for ")+o.page.name,rows:1,ref:"recommendContent",hasEventEnter:!1,autofocus:!0,className:"max-h-[75vh] lg:max-h-[60vh]"},null,8,["modelValue","placeholder"])]),i(p,{onEmoji_click:c.addEmoji},null,8,["onEmoji_click"])]),s("div",Y,[i(f,{onClick:t[1]||(t[1]=d=>c.handleClickRecommend())},{default:m(()=>[_(a(e.$t("Send")),1)]),_:1})])])}const T=L(A,[["render",D]]),U={components:{BaseButton:R,PostListsItem:V,Loading:B,InfiniteLoading:E},props:["userInfo"],data(){return{userReviewInfo:this.userInfo,currentPage:1}},computed:{...v(k,["user"]),...v(g,["postsList","loadingPostsList"])},mounted(){this.getReviewsPageList(this.userReviewInfo.id,this.currentPage)},unmounted(){this.unsetPostsList()},methods:{...I(g,["getReviewsPageList","unsetPostsList"]),handleClickRecommend(e){this.$dialog.open(T,{data:{page:this.userReviewInfo,isRecommend:e},props:{header:e?this.$t("Recommend")+" "+this.userReviewInfo.name:this.$t("How can")+" "+this.userReviewInfo.name+" "+this.$t("improve?"),class:"p-dialog-lg",modal:!0,draggable:!1},onClose:async t=>{t.data&&(this.userReviewInfo.can_review=!1)}})},loadMoreReviews(e){this.getReviewsPageList(this.userReviewInfo.id,++this.currentPage).then(t=>{t.length===0?e.complete():e.loaded()})}},emits:["change_tab","update_user_info"]},G={key:0,class:"main-content-section bg-white p-5 mb-base-2 rounded-none md:rounded-base-lg dark:bg-slate-800"},H={class:"text-main-color text-base-lg font-extrabold dark:text-white mb-base-2"},O={class:"flex gap-base-2"},Q={class:"flex-1"},W={class:"flex-1"},q={class:"flex gap-base-2 justify-between items-center mb-base-2 px-base-2 md:px-0"},z={class:"text-main-color text-base-lg font-extrabold dark:text-white"},J={key:2},K={key:0,class:"pb-5"},X={key:1,class:"main-content-section bg-white border border-white text-main-color p-5 text-center rounded-none mb-base-2 md:rounded-base-lg dark:bg-slate-800 dark:border-slate-800 dark:text-white"},Z={class:"text-base-sm"};function ee(e,t,y,P,o,c){const u=r("BaseButton"),h=r("Loading"),p=r("PostListsItem"),f=r("InfiniteLoading");return n(),l(w,null,[o.userReviewInfo.can_review?(n(),l("div",G,[s("h3",H,a(e.$t("Do you recommend")+" "+o.userReviewInfo.name+"?"),1),s("div",O,[s("div",Q,[i(u,{type:"secondary",class:"w-full",onClick:t[0]||(t[0]=d=>c.handleClickRecommend(!0))},{default:m(()=>[_(a(e.$t("Yes")),1)]),_:1})]),s("div",W,[i(u,{type:"secondary",class:"w-full",onClick:t[1]||(t[1]=d=>c.handleClickRecommend(!1))},{default:m(()=>[_(a(e.$t("No")),1)]),_:1})])])])):N("",!0),s("div",q,[s("h3",z,a(e.$t("Rating"))+" Â· "+a(o.userReviewInfo.review_score)+" "+a(e.$filters.numberShortener(o.userReviewInfo.review_count,e.$t("([number] review)"),e.$t("([number] reviews)"))),1)]),e.loadingPostsList?(n(),b(h,{key:1})):(n(),l("div",J,[e.postsList.length>0?(n(),l("div",K,[i(S,{name:"fade"},{default:m(()=>[(n(!0),l(w,null,j(e.postsList,d=>(n(),b(p,{key:d.id,post:d},null,8,["post"]))),128))]),_:1}),i(f,{onInfinite:c.loadMoreReviews},{spinner:m(()=>[i(h)]),complete:m(()=>t[2]||(t[2]=[s("span",null,null,-1)])),_:1},8,["onInfinite"])])):(n(),l("div",X,[s("div",Z,a(e.$t("Nothing to see here yet")),1)]))]))],64)}const ie=L(U,[["render",ee]]);export{ie as default};
