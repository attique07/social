import{I as _,h as C,C as i,a8 as P,q as d,s as v,_ as w,r,o as n,c as m,b as a,a as c,F as g,v as k,e as u,t as y}from"../../assets/app-73d10358.js";import{P as F}from"./PostDetailModal-38c76a2f.js";import{P as N,C as $,u as B}from"./CommentsList-b62f7880.js";const D={components:{PostContent:N,CommentForm:$,ContentHtml:_,UserName:C},props:["post"],data(){return{comment:{subject_type:"post",subject_id:null}}},methods:{...i(B,["postComment"]),...i(P,["addCommentToPost"]),showPostDetail(){let e=this.$router.resolve({name:"post",params:{id:this.post.id}});d(e.fullPath),this.$dialog.open(F,{data:{post:this.post},props:{class:"post-detail-modal p-dialog-lg p-dialog-full-page",modal:!0,dismissableMask:!0,showHeader:!1,draggable:!1},onClose:()=>{d(this.$router.currentRoute.value.fullPath),v()}})},focusCommentBox(){this.$refs.commentForm.setContent("")},async postNewComment(e){try{await this.postComment({subject_type:"posts",subject_id:this.post.id,content:e,replies:[]}).then(t=>{this.addCommentToPost(t,this.post.id)}),this.$refs.commentForm.setContent("")}catch(t){this.showError(t.error)}}}},U={class:"feed-item bg-white border border-white rounded-none md:rounded-base-lg p-4 mb-base-2 dark:bg-slate-800 dark:border-slate-800"},V={class:"feed-comment-info-comment-holder"},j={key:0,class:"-mt-1 mb-base-1"},x={key:1,class:"feed-comment-info-comment-holder-view-all text-sub-color dark:text-slate-400 -mt-1 mb-2"},H={class:"border-t border-divider dark:border-white/10 feed-comment-info-comment-holder-border"};function L(e,t,s,S,E,l){const p=r("PostContent"),h=r("UserName"),b=r("ContentHtml"),f=r("CommentForm");return n(),m("div",U,[a(p,{post:s.post,autoPlay:!0,onComment_click:t[0]||(t[0]=o=>l.showPostDetail())},null,8,["post"]),c("div",V,[s.post.commentsList.length>0?(n(),m("div",j,[(n(!0),m(g,null,k(s.post.commentsList,o=>(n(),m("div",{key:o.id,class:"feed-comment-info-comment-holder-comment"},[a(h,{user:o.user,activePopover:!1,class:"comment-item-username float-start me-1 max-w-full"},null,8,["user"]),a(b,{content:o.content,mentions:o.mentions,class:"comment-item-content break-normal"},null,8,["content","mentions"])]))),128))])):u("",!0),s.post.comment_count>0?(n(),m("div",x,[c("button",{onClick:t[1]||(t[1]=o=>l.showPostDetail())},y(e.$filters.numberShortener(s.post.comment_count,e.$t("View all [number] comment"),e.$t("View all [number] comments"))),1)])):u("",!0),c("div",H,[a(f,{ref:"commentForm",onPost_comment:l.postNewComment,class:"pt-base-2"},null,8,["onPost_comment"])])])])}const q=w(D,[["render",L]]);export{q as P};
